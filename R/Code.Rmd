---
title: "Code"
author: "LR"
date: '2022-06-28'
output: html_document
editor_options: 
  chunk_output_type: inline
---
# Porpuse: This .Rmd document provides the code we used for data processing and data visualization.

## Data processing workflow.
```{r - loading packages and data sets, include=FALSE}
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)
study_info <- read_csv(here("Data", "study_info.csv"))
species_info <- read_csv(here("Data", "species_info.csv"))
pfas_info <- read_csv(here("Data", "pfas_info.csv"))
cohort_info <- read_csv(here("Data", "cohort_info.csv"))
sample_info <- read_csv(here("Data", "sample_info.csv"))
measurements <- read_csv(here("Data", "measurement.csv"))
```

```{r - join matching rows of different data sets}
ms <- left_join(measurement, sample_info, by = "sample_ID")
msc <- left_join(ms, cohort_info, by = "cohort_ID")
mscs <- left_join(msc, study_info, by = "study_ID")
mscsp <- left_join(mscs, pfas_info, by = "pfas_ID")
mscsps <- left_join(mscsp, species_info, by = "species_ID")
data_combined <- mscsps %>% 
  select(-c(Timestamp.x, Timestamp.y, Timestamp.x.x, Timestamp.y.y, Timestamp.x.x.x, Timestamp.y.y.y))
View(data_combined)
```
# Clean the dataframe removing comment and statement columns
```{r cleaning}
data_combined <- data_combined %>% 
  select(- ends_with("comment")) %>% 
  select(- ends_with("statement"))
```
# Remove rows having NA values in mean_arithmetic, SD, or n columns
```{r remove na}
data_combined <- data_combined %>% drop_na(mean_arithmetic, SD, n)
```

```{r}
p <- ggplot(data_combined)+
  geom_boxplot(aes(x=group_info, lower=mean_arithmetic-SD, upper=mean_arithmetic+SD, middle=mean_arithmetic, ymin=mean_arithmetic-3*SD, ymax=mean_arithmetic+3*SD), stat = "identity")
p
```


## To calculate the overall [PFAS]adult / [PFAS]progeny ratio I need to devide the mean of egg for the mean of adult (group_info).
```{r}
#progeny <- filter(data_combined, group_info == "egg" | group_info == "chick")
#adult <- filter(data_combined, group_info == "adult")
#ggplot(data_combined) %>% 
  #geom_point(aes(x=group_by() mean_arithmetic, y=adult$mean_arithmetic))
```

## Summary of scientific and common names of the species
```{r}
data_combined %>% group_by(species_scientific_name, species_common_name) %>% summarise()
```

## Overall meta-analytic mean calculation:
```{r}
#TODO


```


