---
title: "loop to create effect size IDs"
author: "LR"
date: "2022-10-26"
output: html_document
---

Here I create a semplified example of my measurements data table (i.e., df).
I want to create unique effect size IDs (es_ID) that match specific measurements (i.e., rows).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

df <- 
  data.frame(study_ID = rep(LETTERS[1:3],
                        each = 4), 
             pfas_ID = rep(LETTERS[4:6],
                        each = 2), 
             species_ID = c('F', 'F', 'F', 'F', 'G', 'G'), 
             sampling_location = c('H', 'H', 'I', 'I', 'L', 'L'), 
             tissue_type = c('M', 'N', 'O', 'N', 'M', 'P', 'M', 'N', 'O', 'N', 'M', 'N'),
             group_ID = c('x', 'y', 'x', 'y', 'x', 'y'), 
             es_ID = c('', '', '', '', '', '')) 
df
```

I want to fill up the column 'es_ID' following these criteria:

- when two rows have *same* study_ID AND pfas_ID AND species_ID AND sampling_location AND *different* tissue_type AND group_ID -> assign same unique es_ID value to the two rows

- If a row has more then one match (due to more then one tissue_type in the group) -> duplicate the row and assign same unique es_ID value to the two rows

- when two rows have *different* study_ID OR pfas_ID OR species_ID OR sampling_location OR *same* group_ID -> do not do anything

Thus, I want to create a loop that compare each row with any row in the data table.
Each decision of the loop ends assigning a new unique es_ID to the two rows OR doing nothing.
Each row will have at least one matching row. So each row will have at least one es_ID.

At the end, in this case and if the loop worked, I will have this result:

```{r}

df2 <- 
  data.frame(study_ID = rep(LETTERS[1:3],
                        each = 4), 
             pfas_ID = rep(LETTERS[4:6],
                        each = 2), 
             species_ID = c('F', 'F', 'F', 'F', 'G', 'G'), 
             sampling_location = c('H', 'H', 'I', 'I', 'L', 'L'), 
             tissue_type = c('M', 'N', 'O', 'N', 'M', 'P', 'M', 'N', 'O', 'N', 'M', 'N'),
             group_ID = c('x', 'y', 'x', 'y', 'x', 'y'), 
             es_ID = c('1', '1', '2', '2', '3', '3', '4', '4', '5', '5', '6', '6')) 
df2
```

In this case, there are no double rows with different es_ID because there are no rows that match with more than one row.
